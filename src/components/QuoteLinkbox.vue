<template>
  <div class="w-full card-light-shadow rounded-3xl flex flex-row flex-nowrap">
    <div class="flex items-center px-2">
      <svg
        class="handle cursor-grab"
        width="14"
        height="16"
        viewBox="0 0 14 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.75 2.5C6.55109 2.5 6.36032 2.42098 6.21967 2.28033C6.07902 2.13968 6 1.94891 6 1.75C6 1.55109 6.07902 1.36032 6.21967 1.21967C6.36032 1.07902 6.55109 1 6.75 1C6.94891 1 7.13968 1.07902 7.28033 1.21967C7.42098 1.36032 7.5 1.55109 7.5 1.75C7.5 1.94891 7.42098 2.13968 7.28033 2.28033C7.13968 2.42098 6.94891 2.5 6.75 2.5ZM6.75 8.5C6.55109 8.5 6.36032 8.42098 6.21967 8.28033C6.07902 8.13968 6 7.94891 6 7.75C6 7.55109 6.07902 7.36032 6.21967 7.21967C6.36032 7.07902 6.55109 7 6.75 7C6.94891 7 7.13968 7.07902 7.28033 7.21967C7.42098 7.36032 7.5 7.55109 7.5 7.75C7.5 7.94891 7.42098 8.13968 7.28033 8.28033C7.13968 8.42098 6.94891 8.5 6.75 8.5ZM6.75 14.5C6.55109 14.5 6.36032 14.421 6.21967 14.2803C6.07902 14.1397 6 13.9489 6 13.75C6 13.5511 6.07902 13.3603 6.21967 13.2197C6.36032 13.079 6.55109 13 6.75 13C6.94891 13 7.13968 13.079 7.28033 13.2197C7.42098 13.3603 7.5 13.5511 7.5 13.75C7.5 13.9489 7.42098 14.1397 7.28033 14.2803C7.13968 14.421 6.94891 14.5 6.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M1.75 2.5C1.55109 2.5 1.36032 2.42098 1.21967 2.28033C1.07902 2.13968 1 1.94891 1 1.75C1 1.55109 1.07902 1.36032 1.21967 1.21967C1.36032 1.07902 1.55109 1 1.75 1C1.94891 1 2.13968 1.07902 2.28033 1.21967C2.42098 1.36032 2.5 1.55109 2.5 1.75C2.5 1.94891 2.42098 2.13968 2.28033 2.28033C2.13968 2.42098 1.94891 2.5 1.75 2.5ZM1.75 8.5C1.55109 8.5 1.36032 8.42098 1.21967 8.28033C1.07902 8.13968 1 7.94891 1 7.75C1 7.55109 1.07902 7.36032 1.21967 7.21967C1.36032 7.07902 1.55109 7 1.75 7C1.94891 7 2.13968 7.07902 2.28033 7.21967C2.42098 7.36032 2.5 7.55109 2.5 7.75C2.5 7.94891 2.42098 8.13968 2.28033 8.28033C2.13968 8.42098 1.94891 8.5 1.75 8.5ZM1.75 14.5C1.55109 14.5 1.36032 14.421 1.21967 14.2803C1.07902 14.1397 1 13.9489 1 13.75C1 13.5511 1.07902 13.3603 1.21967 13.2197C1.36032 13.079 1.55109 13 1.75 13C1.94891 13 2.13968 13.079 2.28033 13.2197C2.42098 13.3603 2.5 13.5511 2.5 13.75C2.5 13.9489 2.42098 14.1397 2.28033 14.2803C2.13968 14.421 1.94891 14.5 1.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M11.75 2.5C11.5511 2.5 11.3603 2.42098 11.2197 2.28033C11.079 2.13968 11 1.94891 11 1.75C11 1.55109 11.079 1.36032 11.2197 1.21967C11.3603 1.07902 11.5511 1 11.75 1C11.9489 1 12.1397 1.07902 12.2803 1.21967C12.421 1.36032 12.5 1.55109 12.5 1.75C12.5 1.94891 12.421 2.13968 12.2803 2.28033C12.1397 2.42098 11.9489 2.5 11.75 2.5ZM11.75 8.5C11.5511 8.5 11.3603 8.42098 11.2197 8.28033C11.079 8.13968 11 7.94891 11 7.75C11 7.55109 11.079 7.36032 11.2197 7.21967C11.3603 7.07902 11.5511 7 11.75 7C11.9489 7 12.1397 7.07902 12.2803 7.21967C12.421 7.36032 12.5 7.55109 12.5 7.75C12.5 7.94891 12.421 8.13968 12.2803 8.28033C12.1397 8.42098 11.9489 8.5 11.75 8.5ZM11.75 14.5C11.5511 14.5 11.3603 14.421 11.2197 14.2803C11.079 14.1397 11 13.9489 11 13.75C11 13.5511 11.079 13.3603 11.2197 13.2197C11.3603 13.079 11.5511 13 11.75 13C11.9489 13 12.1397 13.079 12.2803 13.2197C12.421 13.3603 12.5 13.5511 12.5 13.75C12.5 13.9489 12.421 14.1397 12.2803 14.2803C12.1397 14.421 11.9489 14.5 11.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </div>
    <div class="w-full">
      <div class="flex justify-between items-center w-full pt-2 pr-2">
        <div>
          <div class="">
            <span
              class="px-3 py-[1px] rounded-[1rem] bg-amber-300/20 text-xs font-medium text-amber-600/70"
              >Text</span
            >
          </div>
        </div>
        <div class="">
          <div>
            <label
              class="relative inline-flex items-center mb-5 cursor-pointer"
            >
              <input
                type="checkbox"
                v-model="isActive"
                @change="updateLink"
                value="true"
                class="sr-only peer"
              />
              <div
                class="w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-purple-600"
              ></div>
            </label>
          </div>
        </div>
      </div>
      <div :id="`LinkBox${link.id}`" class="w-full">
        <div id="MainLinkBoxSection" class="relative md:px-8 pt-2 pb-14">
          <div class="">
            <!-- <label for="Title" class="text-sm leading-6 text-gray-600"
                  >Title</label
                > -->
            <div class="relative mb-0.5 w-auto font-medium">
              <!-- <textarea
                            v-model="text"
                            @change="updateLink"
                            rows="4"
                            maxlength="80"
                            placeholder="Type your anything here ..."
                            class="w-full inputs font-medium !text-[0.98rem] bg-transparent focus:bg-gray-50 focus:border-opacity-0 focus:border-gray-100 text-gray-900 text-sm rounded-lg focus:ring-blue-50 block pl-4 p-2.5 resize-none"
                        ></textarea> -->
              <textarea
                type="text"
                v-model="text"
                @change="updateLink"
                id="input-group-1"
                class="inputs w-full h-min bg-transparent focus:bg-gray-50 focus:border-opacity-0 focus:border-gray-100 text-gray-900 text-sm rounded-lg focus:ring-blue-50 block pl-4 p-2.5"
                placeholder="Quote/Text"
              ></textarea>
            </div>
          </div>

          <div
            class="absolute z-10 inset-x-0 bottom-0 flex items-center rounded-[10px] p-[0.375rem]"
          >
            <div class="flex flex-col items-center justify-center w-full">
              <div class="bgfilterblur p-1 rounded-[2.5rem]">
                <button
                  @click="isEmbbedLink = !isEmbbedLink"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-1.5 text-black"
                  :class="
                    isEmbbedLink ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isEmbbedLink ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"
                    />
                  </svg>
                </button>
                <button
                  @click="isUpdateLayout = !isUpdateLayout"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-1.5 text-black"
                  :class="
                    isUpdateLayout ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isUpdateLayout ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"
                    />
                  </svg>
                </button>
                <button
                  @click="isMoreOption = !isMoreOption"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-1.5 text-black"
                  :class="
                    isMoreOption ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isMoreOption ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"
                    />
                  </svg>
                </button>

                <button
                  @click="
                    isDelete = true;
                    isEmbbedLink = false;
                  "
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none !p-1.5 text-black"
                  :class="isDelete ? ' bg-white text-purple-700 shadow-lg' : ''"
                  :color="isDelete ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5 cursor-pointer"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkDeleteSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[180px] transition-all duration-300 ease-in mt-10':
                isDelete,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isDelete,
            },
          ]"
        >
          <button
            @click="isDelete = false"
            class="relative w-full bg-[#DFE2D9] py-1.5"
          >
            <Icon
              name="mdi:close"
              class="absolute right-1 top-[6px] cursor-pointer"
              size="20"
              color="#45494A"
            />
            <div class="text-center text-sm font-bold text-gray-950">
              Delete
            </div>
          </button>

          <div class="flex items-center justify-center pt-3 text-gray-950">
            Delete this forever?
          </div>

          <div class="w-full px-4 py-3">
            <div class="flex items-center gap-2 w-full">
              <button
                @click="deleteLink()"
                class="flex items-center border justify-center w-full py-3 rounded-full text-gray-950 hover:text-gray-200 font-semibold hover:bg-gray-900"
              >
                Remove
              </button>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkBoxSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[180px] transition-all duration-300 ease-in mt-10 ':
                isEmbbedLink,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isEmbbedLink,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <svg
              @click="isEmbbedLink = false"
              color="#45494A"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="absolute right-1 top-[6px] cursor-pointer w-5 h-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>

            <div class="text-center text-sm font-bold text-[#45494A]">
              Add Link
            </div>
          </div>

          <div class="w-full flex items-center justify-between px-4 py-5">
            <div class="">
              <!-- <label for="url" class="text-sm leading-6 text-gray-600"
                  >url</label
                > -->
              <div class="relative w-auto font-medium">
                <input
                  type="text"
                  v-model="url"
                  @change="updateLink"
                  id="input-group-1"
                  class="inputs bg-transparent focus:bg-gray-50 focus:border-opacity-0 focus:border-gray-100 text-gray-900 text-sm rounded-lg focus:ring-blue-50 block pl-4 p-2.5"
                  placeholder="Url"
                />
                <div
                  class="absolute inset-y-0 left-0 flex items-center pr-3.5 pointer-events-none"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    class="w-4 h-4 text-gray-500"
                  >
                    <path
                      d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"
                    />
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkLayoutSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[220px] transition-all duration-300 ease-in mt-10':
                isUpdateLayout,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isUpdateLayout,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <svg
              @click="isUpdateLayout = false"
              color="#45494A"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="absolute right-1 top-[6px] cursor-pointer w-5 h-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>

            <div class="text-center text-sm font-bold text-[#45494A]">
              Choose Layout
            </div>
          </div>

          <div class="w-full px-4 py-5">
            <form @submit.prevent="updateCategory()">
              <!-- Sizes -->
              <div class="mt-10">
                <RadioGroup
                  v-model="layout"
                  @update:modelValue="(value) => updateLink()"
                  class="mt-4"
                >
                  <RadioGroupLabel class="sr-only"
                    >Choose a layout</RadioGroupLabel
                  >
                  <div
                    class="mt-3 flex flex-row flex-nowrap items-center justify-between"
                  >
                    <RadioGroupOption
                      as="div"
                      value="Cube"
                      v-slot="{ active, checked }"
                      class=""
                    >
                      <div
                        class="relative px-6 py-5 bg-gray-200 p-2 rounded-lg"
                        :class="[checked ? 'border-2 border-purple-700' : '']"
                      >
                        <div class="absolute top-0 left-0">
                          <div
                            class="p-1 text-purple-700"
                            :class="[checked ? 'flex items-center' : ' hidden']"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              fill="none"
                              viewBox="0 0 24 24"
                              stroke-width="2.5"
                              stroke="currentColor"
                              class="w-6 h-6"
                            >
                              <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                              />
                            </svg>
                          </div>
                        </div>
                        <div
                          class="w-[60px] bg-white h-auto rounded-[0.8rem] p-2 flex flex-col"
                        >
                          <div
                            class="mb-2 bg-gray-200 rounded-[1rem] w-2 h-2"
                          ></div>
                          <div
                            class="mb-2 bg-gray-200 rounded-[1rem] w-10 h-1.5"
                          ></div>
                          <div
                            class="mb-2 bg-gray-200 rounded-[1rem] w-8 h-1"
                          ></div>
                        </div>
                      </div>
                    </RadioGroupOption>
                    <RadioGroupOption
                      as="div"
                      value="Verticalbar"
                      v-slot="{ active, checked }"
                      class=""
                    >
                      <div
                        class="relative px-2 py-8 bg-gray-200 rounded-lg flex items-center"
                        :class="[checked ? 'border-2 border-purple-700' : '']"
                      >
                        <div class="absolute top-0 left-0">
                          <div
                            class="p-1 text-purple-700"
                            :class="[checked ? 'flex items-center' : ' hidden']"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              fill="none"
                              viewBox="0 0 24 24"
                              stroke-width="2.5"
                              stroke="currentColor"
                              class="w-6 h-6"
                            >
                              <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                              />
                            </svg>
                          </div>
                        </div>
                        <div class="bg-white rounded-[2rem] p-2 flex flex-row">
                          <div
                            class="mr-2 bg-gray-200 rounded-[1rem] w-4 h-4"
                          ></div>
                          <div class="mr-[2.5rem] flex flex-col">
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-10 h-1.5"
                            ></div>
                            <div
                              class="bg-gray-200 rounded-[1rem] w-8 h-1"
                            ></div>
                          </div>
                        </div>
                      </div>
                    </RadioGroupOption>
                    <RadioGroupOption
                      as="div"
                      value="Horizontalbar"
                      v-slot="{ active, checked }"
                      class=""
                    >
                      <div
                        class="relative px-2 py-5 bg-gray-200 p-2 rounded-lg mr-1"
                        :class="[checked ? 'border-2 border-purple-700' : '']"
                      >
                        <div class="absolute top-0 left-0">
                          <div
                            class="p-1 text-purple-700"
                            :class="[checked ? 'flex items-center' : ' hidden']"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              fill="none"
                              viewBox="0 0 24 24"
                              stroke-width="2.5"
                              stroke="currentColor"
                              class="w-6 h-6"
                            >
                              <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                              />
                            </svg>
                          </div>
                        </div>
                        <div
                          class="bg-white w-auto h-auto rounded-[0.6rem] p-2 flex flex-row"
                        >
                          <div class="flex flex-col">
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-4 h-4"
                            ></div>
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-10 h-1.5"
                            ></div>
                            <div
                              class="bg-gray-200 rounded-[1rem] w-8 h-1.5"
                            ></div>
                          </div>
                          <div class="ml-1 p-0.5">
                            <div
                              class="bg-gray-200 rounded-[0.3rem] w-[50px] h-[40px]"
                            ></div>
                          </div>
                        </div>
                      </div>
                    </RadioGroupOption>
                    <RadioGroupOption
                      as="div"
                      value="Block"
                      v-slot="{ active, checked }"
                      class=""
                    >
                      <div
                        class="relative px-2 py-2 bg-gray-200 p-2 rounded-lg mr-1"
                        :class="[checked ? 'border-2 border-purple-700' : '']"
                      >
                        <div class="absolute top-0 left-0">
                          <div
                            class="p-1 text-purple-700"
                            :class="[checked ? 'flex items-center' : ' hidden']"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              fill="none"
                              viewBox="0 0 24 24"
                              stroke-width="2.5"
                              stroke="currentColor"
                              class="w-6 h-6"
                            >
                              <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                              />
                            </svg>
                          </div>
                        </div>
                        <div
                          class="bg-white w-auto h-auto rounded-[1rem] p-2 flex flex-col"
                        >
                          <div class="flex flex-col">
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-4 h-4"
                            ></div>
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-10 h-1.5"
                            ></div>
                            <div
                              class="mb-1 bg-gray-200 rounded-[1rem] w-8 h-1"
                            ></div>
                          </div>
                          <div class="">
                            <div
                              class="bg-gray-200 rounded-[0.3rem] w-[80px] h-[30px]"
                            ></div>
                          </div>
                        </div>
                      </div>
                    </RadioGroupOption>
                  </div>
                </RadioGroup>
              </div>

              <!-- <button
                        type="submit"
                        class="mt-6 flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
                    >
                        Save
                    </button> -->
            </form>
          </div>
        </div>

        <div
          id="FooterLinkLayoutSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[480px] transition-all duration-300 ease-in mt-10':
                isMoreOption,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isMoreOption,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <svg
              @click="isMoreOption = false"
              color="#45494A"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="absolute right-1 top-[6px] cursor-pointer w-5 h-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>

            <div class="text-center text-sm font-bold text-[#45494A]">
              More options
            </div>
          </div>
          <div class="px-6">
            <div class="mt-10 w-[14rem]">
              <label
                for="username"
                class="text-sm font-medium leading-7 text-gray-900"
                >Font</label
              >
              <div class="mt-2 text-gray-900">
                <Listbox
                  v-model="font"
                  @update:modelValue="(value) => dataChange()"
                >
                  <div class="relative mt-1">
                    <ListboxButton
                      class="relative w-full min-h-[40px] cursor-default rounded-lg bg-gray-50 py-2 pl-3 pr-10 text-left focus:outline-none focus-visible:border-indigo-500 focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 focus-visible:ring-offset-orange-300 sm:text-sm"
                    >
                      <span class="block truncate">{{ font }}</span>
                      <span
                        class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"
                      >
                        <ChevronUpDownIcon
                          class="h-5 w-5 text-gray-400"
                          aria-hidden="true"
                        />
                      </span>
                    </ListboxButton>

                    <transition
                      leave-active-class="transition duration-100 ease-in"
                      leave-from-class="opacity-100"
                      leave-to-class="opacity-0"
                    >
                      <ListboxOptions
                        class="absolute z-[1] mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"
                      >
                        <ListboxOption
                          v-slot="{ active, selected }"
                          v-for="font in fonts"
                          :key="font.name"
                          :value="font.name"
                          as="template"
                        >
                          <li
                            :class="[
                              active
                                ? 'bg-amber-100 text-amber-900'
                                : 'text-gray-900',
                              'relative cursor-default select-none py-2 pl-10 pr-4',
                            ]"
                          >
                            <span
                              :class="[
                                selected ? 'font-medium' : 'font-normal',
                                'block truncate',
                              ]"
                              >{{ font.name }}</span
                            >
                            <span
                              v-if="selected"
                              class="absolute inset-y-0 left-0 flex items-center pl-3 text-amber-600"
                            >
                              <CheckIcon class="h-5 w-5" aria-hidden="true" />
                            </span>
                          </li>
                        </ListboxOption>
                      </ListboxOptions>
                    </transition>
                  </div>
                </Listbox>
              </div>
            </div>
            <div class="mt-4">
              <label
                for="position"
                class="text-sm font-medium leading-7 text-gray-900"
                >text position</label
              >
              <div
                class="w-full flex items-center flex-row flex-wrap px-4 py-2"
              >
                <div class="w-full">
                  <!-- text position -->
                  <div class="text-black">
                    <RadioGroup
                      v-model="selectedTextAlign"
                      @update:modelValue="(value) => dataChange()"
                      class=""
                    >
                      <RadioGroupLabel class="sr-only"
                        >Choose a size</RadioGroupLabel
                      >
                      <div class="flex flex-row items-center">
                        <RadioGroupOption
                          as="template"
                          v-for="position in textAlign"
                          :key="position.name"
                          :value="position.name"
                          v-slot="{ active, checked }"
                          class="min-w-[80px]"
                        >
                          <div
                            :class="[
                              active
                                ? 'bg-purple-700 text-white'
                                : 'text-gray-950',
                              checked
                                ? 'bg-purple-700 text-white'
                                : 'border-transparent',
                              'group relative flex items-center justify-center  w-auto mb-3 rounded-full  py-1 px-0.5 text-sm font-medium  focus:outline-none sm:flex-1',
                            ]"
                          >
                            <span v-html="position.icon" />

                            <span
                              :class="[
                                active ? '' : '',
                                checked ? '' : 'border-transparent',
                                'pointer-events-none absolute -inset-px rounded-full',
                              ]"
                              aria-hidden="true"
                            />
                          </div>
                        </RadioGroupOption>
                      </div>
                    </RadioGroup>
                  </div>
                </div>
                <div class="w-full">
                  <!-- text position -->
                  <div class="text-black">
                    <RadioGroup
                      v-model="selectedTextPosition"
                      @update:modelValue="(value) => dataChange()"
                      class=""
                    >
                      <RadioGroupLabel class="sr-only"
                        >Choose a size</RadioGroupLabel
                      >
                      <div class="flex flex-row flex-wrap items-center">
                        <RadioGroupOption
                          as="template"
                          v-for="position in position"
                          :key="position"
                          :value="position.name"
                          v-slot="{ active, checked }"
                          class="min-w-[80px]"
                        >
                          <div
                            :class="[
                              active
                                ? 'bg-purple-700 text-white'
                                : 'text-gray-950',
                              checked
                                ? 'bg-purple-700 text-white'
                                : 'border-transparent',
                              'group relative flex items-center justify-center  w-auto mb-3 rounded-full  py-1 px-0.5 text-sm font-medium focus:outline-none sm:flex-1',
                            ]"
                          >
                            <span v-html="position.icon" />

                            <span
                              :class="[
                                active ? '' : '',
                                checked ? '' : 'border-transparent',
                                'pointer-events-none absolute -inset-px rounded-full',
                              ]"
                              aria-hidden="true"
                            />
                          </div>
                        </RadioGroupOption>
                      </div>
                    </RadioGroup>
                  </div>
                </div>
              </div>
            </div>
            <div class="mt-2 mb-8 text-black">
              <label
                for="bgcolor"
                class="text-sm font-medium leading-7 text-gray-900"
                >Background Color</label
              >

              <div class="w-full px-4">
                <RadioGroup
                  v-model="bgColor"
                  @update:modelValue="(value) => dataChange()"
                  class="my-4"
                >
                  <RadioGroupLabel class="sr-only"
                    >Choose a color</RadioGroupLabel
                  >
                  <span
                    class="flex flex-row flex-wrap items-center space-x-3 space-y-2"
                  >
                    <RadioGroupOption
                      as="template"
                      v-for="color in colors"
                      :key="color.name"
                      :value="color.class"
                      v-slot="{ active, checked }"
                    >
                      <div
                        class="ring-purple-700"
                        :class="[
                          active && checked ? 'ring ring-offset-1' : '',
                          !active && checked ? 'ring-2' : '',
                          'relative -m-0.5 flex cursor-pointer items-center justify-center rounded-full p-0.5 focus:outline-none',
                        ]"
                      >
                        <RadioGroupLabel as="span" class="sr-only">{{
                          color.name
                        }}</RadioGroupLabel>
                        <span
                          aria-hidden="true"
                          :class="[
                            color.class,
                            'h-8 w-8 rounded-full border border-black border-opacity-10',
                          ]"
                        />
                      </div>
                    </RadioGroupOption>
                  </span>
                </RadioGroup>
              </div>
            </div>
          </div>
        </div>

        <CropperModal
          v-if="openCropper"
          :linkId="link.id"
          @data="data = $event"
          @close="openCropper = false"
        />
      </div>
    </div>
  </div>
</template>

<script setup>
import {
  Listbox,
  ListboxLabel,
  ListboxButton,
  ListboxOptions,
  ListboxOption,
} from "@headlessui/vue";
import { CheckIcon, ChevronUpDownIcon } from "@heroicons/vue/20/solid";
import {
  TransitionRoot,
  TransitionChild,
  Dialog,
  DialogPanel,
  DialogTitle,
  RadioGroup,
  RadioGroupLabel,
  RadioGroupOption,
} from "@headlessui/vue";
import CropperModal from "./CropperModal.vue";
import debounce from "lodash/debounce";
import { watch, ref, onMounted, toRefs } from "vue";
import { useStore } from "vuex";
const store = useStore();

const props = defineProps({
  link: Object,
});
const { link } = toRefs(props);
const model = ref(JSON.parse(JSON.stringify(props.link)));

const emit = defineEmits(["updatedInput"]);

let name = ref("");
let text = ref("");
let url = ref("");
let layout = ref("");
let data = ref(null);
let font = ref("");
let bgColor = ref("");

let isActive = ref(false);
let isDelete = ref(false);
let openCropper = ref(false);
let isEmbbedLink = ref(false);
let isUpdateLayout = ref(false);
let isMoreOption = ref(false);
let errors = ref(null);

const fonts = [
  {
    name: "Courgette",
  },
  {
    name: "Dancing Script",
  },
  {
    name: "Fredoka",
  },
  {
    name: "Pacifico",
  },
];

const colors = [
  { name: "White", class: "bg-white" },
  { name: "Gray", class: "bg-gray-200" },
  { name: "Black", class: "bg-gray-900" },
  { name: "brown", class: "bg-[#FEC86E]" },
  { name: "redish", class: "bg-[#FD9A71]" },
  { name: "greenish", class: "bg-[#E2EE8C]" },
  { name: "purplish", class: "bg-[#B291FA]" },
  { name: "bluish", class: "bg-[#00D3FB]" },
];

const Layout = [
  {
    name: "Cube",
    icon: `
        <svg
                            class="w-5 h-5"
                            viewBox="0 0 10 10"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.33333C1 1.97971 1.14048 1.64057 1.39052 1.39052C1.64057 1.14048 1.97971 1 2.33333 1H7.66667C8.02029 1 8.35943 1.14048 8.60948 1.39052C8.85952 1.64057 9 1.97971 9 2.33333V7.66667C9 8.02029 8.85952 8.35943 8.60948 8.60948C8.35943 8.85952 8.02029 9 7.66667 9H2.33333C1.97971 9 1.64057 8.85952 1.39052 8.60948C1.14048 8.35943 1 8.02029 1 7.66667V2.33333Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Verticalbar",

    icon: `
        <svg
                            class=""
                            width="31"
                            height="19"
                            viewBox="0 0 21 9"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.16667C1 1.85725 1.33363 1.5605 1.9275 1.34171C2.52136 1.12292 3.32681 1 4.16667 1H16.8333C17.6732 1 18.4786 1.12292 19.0725 1.34171C19.6664 1.5605 20 1.85725 20 2.16667V6.83333C20 7.14275 19.6664 7.4395 19.0725 7.65829C18.4786 7.87708 17.6732 8 16.8333 8H4.16667C3.32681 8 2.52136 7.87708 1.9275 7.65829C1.33363 7.4395 1 7.14275 1 6.83333V2.16667Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Horizontalbar",

    icon: `
        <svg
                            class=""
                            width="21"
                            height="13"
                            viewBox="0 0 21 13"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.83333C1 2.3471 1.33363 1.88079 1.9275 1.53697C2.52136 1.19315 3.32681 1 4.16667 1H16.8333C17.6732 1 18.4786 1.19315 19.0725 1.53697C19.6664 1.88079 20 2.3471 20 2.83333V10.1667C20 10.6529 19.6664 11.1192 19.0725 11.463C18.4786 11.8068 17.6732 12 16.8333 12H4.16667C3.32681 12 2.52136 11.8068 1.9275 11.463C1.33363 11.1192 1 10.6529 1 10.1667V2.83333Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Block",

    icon: `
        <svg class="" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M1 3.25C1 2.65326 1.23705 2.08097 1.65901 1.65901C2.08097 1.23705 2.65326 1 3.25 1H12.25C12.8467 1 13.419 1.23705 13.841 1.65901C14.2629 2.08097 14.5 2.65326 14.5 3.25V12.25C14.5 12.8467 14.2629 13.419 13.841 13.841C13.419 14.2629 12.8467 14.5 12.25 14.5H3.25C2.65326 14.5 2.08097 14.2629 1.65901 13.841C1.23705 13.419 1 12.8467 1 12.25V3.25Z"  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `,
  },
];

const selectedLayout = ref(Layout[0]);

const textAlign = [
  {
    name: "left",
    icon: `
        <svg
                            class="w-5 h-5"
                            width="18"
                            height="12"
                            viewBox="0 0 18 12"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M0.75 0.75H17.25M0.75 6H9M0.75 11.25H17.25"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "center",

    icon: `
        <svg
                            class=""
                            width="18"
                            height="12"
                            viewBox="0 0 18 12"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M0.75 0.75H17.25M5 6H13.25M0.75 11.25H17.25"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "right",
    icon: `
        <svg
                            class=""
                            width="18"
                            height="12"
                            viewBox="0 0 18 12"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M17.25 11.25L0.75 11.25M17.25 6L9 6M17.25 0.75L0.75 0.75"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
];
const position = [
  {
    name: "top",
    icon: `
        <svg
                            class=""
                            width="12"
                            height="18"
                            viewBox="0 0 12 18"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M0.75 17.25L0.75 0.75M6 17.25L6 9M11.25 17.25L11.25 0.75"
                                
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "middle",

    icon: `
        <svg
                            class=""
                            width="12"
                            height="18"
                            viewBox="0 0 12 18"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M11.25 0.75L11.25 17.25M6 5.25L6 13.5M0.75 0.75L0.75 17.25"
                                
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Bottom",

    icon: `
        <svg
                            class=""
                            width="13"
                            height="19"
                            viewBox="0 0 13 19"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M11.5 1L11.5 17.5M6.25 1L6.25 9.25M1 1L1 17.5"
                                
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
];

const selectedTextAlign = ref(textAlign[0].name);
const selectedTextPosition = ref(position[0].name);
console.log(position[0].name);

onMounted(() => {
  name.value = link.value.name;
  text.value = link.value.description;
  url.value = link.value.url;
  layout.value = link.value.layout;
  isActive.value = link.value.active ? true : false;
  font.value = props.link.data?.font || "";
  bgColor.value = props.link.data?.background_color || "";
  selectedLayout.value.name = props.link.data?.Layout || "";
  selectedTextAlign.value = props.link.data?.textAlignment || "";
  selectedTextPosition.value = props.link.data?.textPosition || "";
});

const updateLink = async () => {
  try {
    await store.dispatch("updateLink", {
      id: link.value.id,
      name: name.value,
      description: text.value,
      url: url.value,
      layout: layout.value,
      active: isActive.value,
    });
    await store.dispatch("getAllLinks");
  } catch (error) {
    console.log(error);
    errors.value = error.response.data.errors;
  }
};

const dataChange = async () => {
  model.value.data = {
    font: font.value,
    background_color: bgColor.value,
    Layout: selectedLayout.value.name,
    textAlignment: selectedTextAlign.value,
    textPosition: selectedTextPosition.value,
  };
  console.log(model.value.data);

  try {
    await store.dispatch("updateStartupData", model.value);
    await store.dispatch("getAllLinks");
  } catch (error) {
    console.log(error);
  }
};

const updateLinkImage = async () => {
  try {
    await store.dispatch("updateLinkImage", data.value);
    await store.dispatch("getAllLinks");
    setTimeout(() => (openCropper.value = false), 300);
  } catch (error) {
    console.log(error);
  }
};

const updateItemLayout = async () => {
  errors.value = null;

  try {
    await store.dispatch("updateItemLayout", {
      Layout: selectedLayout.value,
      id: link.value.id,
    });
  } catch (error) {
    console.log(error);
    //errors.value = error.response.data.errors;
  }
};

const updateQuoteAlignment = async () => {
  errors.value = null;

  try {
    await store.dispatch("updateQuoteAlignment", {
      id: link.value.id,
      textAlignment: selectedTextAlign.value,
    });
  } catch (error) {
    console.log(error);
    //errors.value = error.response.data.errors;
  }
};
const updateQuotePosition = async () => {
  errors.value = null;

  try {
    await store.dispatch("updateQuotePosition", {
      id: link.value.id,
      textPosition: selectedTextPosition.value,
    });
  } catch (error) {
    console.log(error);
    //errors.value = error.response.data.errors;
  }
};

const deleteLink = async () => {
  let res = confirm("Are you sure you want to delete this link?");
  try {
    if (res) {
      await store.dispatch("deleteLink", link.value.id);
      await store.dispatch("getAllLinks");
    }
  } catch (error) {
    console.log(error);
  }
};

watch(
  () => store.state.user.updatedLinkId.value,
  (val) => {
    if (!val) {
      emit("updatedInput", { id: 0, str: "" });
    }
  }
);

watch(
  () => data.value,
  async () => await updateLinkImage()
);
</script>
