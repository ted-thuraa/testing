<template>
  <div class="w-full card-light-shadow rounded-3xl flex flex-row flex-nowrap">
    <div class="flex items-center px-2">
      <svg
        class="handle"
        width="14"
        height="16"
        viewBox="0 0 14 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.75 2.5C6.55109 2.5 6.36032 2.42098 6.21967 2.28033C6.07902 2.13968 6 1.94891 6 1.75C6 1.55109 6.07902 1.36032 6.21967 1.21967C6.36032 1.07902 6.55109 1 6.75 1C6.94891 1 7.13968 1.07902 7.28033 1.21967C7.42098 1.36032 7.5 1.55109 7.5 1.75C7.5 1.94891 7.42098 2.13968 7.28033 2.28033C7.13968 2.42098 6.94891 2.5 6.75 2.5ZM6.75 8.5C6.55109 8.5 6.36032 8.42098 6.21967 8.28033C6.07902 8.13968 6 7.94891 6 7.75C6 7.55109 6.07902 7.36032 6.21967 7.21967C6.36032 7.07902 6.55109 7 6.75 7C6.94891 7 7.13968 7.07902 7.28033 7.21967C7.42098 7.36032 7.5 7.55109 7.5 7.75C7.5 7.94891 7.42098 8.13968 7.28033 8.28033C7.13968 8.42098 6.94891 8.5 6.75 8.5ZM6.75 14.5C6.55109 14.5 6.36032 14.421 6.21967 14.2803C6.07902 14.1397 6 13.9489 6 13.75C6 13.5511 6.07902 13.3603 6.21967 13.2197C6.36032 13.079 6.55109 13 6.75 13C6.94891 13 7.13968 13.079 7.28033 13.2197C7.42098 13.3603 7.5 13.5511 7.5 13.75C7.5 13.9489 7.42098 14.1397 7.28033 14.2803C7.13968 14.421 6.94891 14.5 6.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M1.75 2.5C1.55109 2.5 1.36032 2.42098 1.21967 2.28033C1.07902 2.13968 1 1.94891 1 1.75C1 1.55109 1.07902 1.36032 1.21967 1.21967C1.36032 1.07902 1.55109 1 1.75 1C1.94891 1 2.13968 1.07902 2.28033 1.21967C2.42098 1.36032 2.5 1.55109 2.5 1.75C2.5 1.94891 2.42098 2.13968 2.28033 2.28033C2.13968 2.42098 1.94891 2.5 1.75 2.5ZM1.75 8.5C1.55109 8.5 1.36032 8.42098 1.21967 8.28033C1.07902 8.13968 1 7.94891 1 7.75C1 7.55109 1.07902 7.36032 1.21967 7.21967C1.36032 7.07902 1.55109 7 1.75 7C1.94891 7 2.13968 7.07902 2.28033 7.21967C2.42098 7.36032 2.5 7.55109 2.5 7.75C2.5 7.94891 2.42098 8.13968 2.28033 8.28033C2.13968 8.42098 1.94891 8.5 1.75 8.5ZM1.75 14.5C1.55109 14.5 1.36032 14.421 1.21967 14.2803C1.07902 14.1397 1 13.9489 1 13.75C1 13.5511 1.07902 13.3603 1.21967 13.2197C1.36032 13.079 1.55109 13 1.75 13C1.94891 13 2.13968 13.079 2.28033 13.2197C2.42098 13.3603 2.5 13.5511 2.5 13.75C2.5 13.9489 2.42098 14.1397 2.28033 14.2803C2.13968 14.421 1.94891 14.5 1.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M11.75 2.5C11.5511 2.5 11.3603 2.42098 11.2197 2.28033C11.079 2.13968 11 1.94891 11 1.75C11 1.55109 11.079 1.36032 11.2197 1.21967C11.3603 1.07902 11.5511 1 11.75 1C11.9489 1 12.1397 1.07902 12.2803 1.21967C12.421 1.36032 12.5 1.55109 12.5 1.75C12.5 1.94891 12.421 2.13968 12.2803 2.28033C12.1397 2.42098 11.9489 2.5 11.75 2.5ZM11.75 8.5C11.5511 8.5 11.3603 8.42098 11.2197 8.28033C11.079 8.13968 11 7.94891 11 7.75C11 7.55109 11.079 7.36032 11.2197 7.21967C11.3603 7.07902 11.5511 7 11.75 7C11.9489 7 12.1397 7.07902 12.2803 7.21967C12.421 7.36032 12.5 7.55109 12.5 7.75C12.5 7.94891 12.421 8.13968 12.2803 8.28033C12.1397 8.42098 11.9489 8.5 11.75 8.5ZM11.75 14.5C11.5511 14.5 11.3603 14.421 11.2197 14.2803C11.079 14.1397 11 13.9489 11 13.75C11 13.5511 11.079 13.3603 11.2197 13.2197C11.3603 13.079 11.5511 13 11.75 13C11.9489 13 12.1397 13.079 12.2803 13.2197C12.421 13.3603 12.5 13.5511 12.5 13.75C12.5 13.9489 12.421 14.1397 12.2803 14.2803C12.1397 14.421 11.9489 14.5 11.75 14.5Z"
          stroke="black"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </div>
    <div class="w-full">
      <div class="flex justify-between items-center w-full pt-2 pr-2">
        <div>
          <div class="">
            <span
              class="px-1 py-[1px] rounded-[1rem] bg-amber-300/20 text-xs font-medium text-amber-600/70"
              >Startup/store/blog</span
            >
          </div>
        </div>
        <div class="">
          <div>
            <label
              class="relative inline-flex items-center mb-5 cursor-pointer"
            >
              <input
                type="checkbox"
                v-model="isActive"
                @change="updateLink"
                value="true"
                class="sr-only peer"
              />
              <div
                class="w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-purple-600"
              ></div>
            </label>
          </div>
        </div>
      </div>
      <div :id="`LinkBox${link.id}`" class="w-full">
        <div id="MainLinkBoxSection" class="relative md:px-8 pt-2 pb-14">
          <div class="">
            <!-- <label for="Title" class="text-sm leading-6 text-gray-600"
                  >Title</label
                > -->
            <div class="relative mb-0.5 w-auto font-medium">
              <input
                type="text"
                v-model="name"
                @change="updateLink"
                id="input-group-1"
                class="inputs w-[20rem] bg-transparent focus:bg-gray-50 focus:border-opacity-0 focus:border-gray-100 text-gray-900 text-sm rounded-lg focus:ring-blue-50 block pl-4 p-2.5"
                placeholder="Title"
              />
              <div
                class="absolute inset-y-0 left-0 flex items-center pr-3.5 pointer-events-none"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  class="w-4 h-4 text-gray-500"
                >
                  <path
                    d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"
                  />
                </svg>

                <!-- <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="w-4 h-4 text-gray-500"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"
                      />
                    </svg> -->
              </div>
            </div>
          </div>

          <div class="">
            <!-- <label for="url" class="text-sm leading-6 text-gray-600"
                  >url</label
                > -->
            <div class="relative w-auto font-medium">
              <input
                type="text"
                v-model="url"
                @change="updateLink"
                id="input-group-1"
                class="inputs bg-transparent focus:bg-gray-50 focus:border-opacity-0 focus:border-gray-100 text-gray-900 text-sm rounded-lg focus:ring-blue-50 block pl-4 p-2.5"
                placeholder="Url"
              />
              <div
                class="absolute inset-y-0 left-0 flex items-center pr-3.5 pointer-events-none"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  class="w-4 h-4 text-gray-500"
                >
                  <path
                    d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"
                  />
                </svg>
              </div>
            </div>
          </div>

          <div
            class="absolute z-10 inset-x-0 bottom-0 flex items-center rounded-[10px] p-[0.375rem]"
          >
            <div class="flex flex-col items-center justify-center w-full">
              <div class="bgfilterblur p-1 rounded-[2.5rem]">
                <button
                  @click="(isUploadImage = !isUploadImage), (isDelete = false)"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-2 text-black"
                  :class="
                    isUploadImage ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isUploadImage ? '#00000' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
                    />
                  </svg>
                </button>
                <button
                  @click="isUpdateLayout = !isUpdateLayout"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-1.5 text-black"
                  :class="
                    isUpdateLayout ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isUpdateLayout ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"
                    />
                  </svg>
                </button>

                <button
                  @click="isEditSaaSData = !isEditSaaSData"
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none mr-2 !p-1.5 text-black"
                  :class="
                    isEditSaaSData ? ' bg-white text-purple-700 shadow-lg' : ''
                  "
                  :color="isEditSaaSData ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    class="cursor-pointer w-5 h-5"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
                    />
                  </svg>
                </button>
                <button
                  @click="
                    isDelete = true;
                    isEmbbedLink = false;
                  "
                  class="cursor-pointer pointer-events-auto rounded-[4rem] outline-none !p-1.5 text-black"
                  :class="isDelete ? ' bg-white text-purple-700 shadow-lg' : ''"
                  :color="isDelete ? '#FFFFFF' : '#676B5F'"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5 cursor-pointer"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkDeleteSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[180px] transition-all duration-300 ease-in mt-10':
                isDelete,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isDelete,
            },
          ]"
        >
          <button
            @click="isDelete = false"
            class="relative w-full bg-[#DFE2D9] py-1.5"
          >
            <Icon
              name="mdi:close"
              class="absolute right-1 top-[6px] cursor-pointer"
              size="20"
              color="#45494A"
            />
            <div class="text-center text-sm font-bold text-gray-950">
              Delete
            </div>
          </button>

          <div class="flex items-center justify-center pt-3 text-gray-950">
            Delete this forever?
          </div>

          <div class="w-full px-4 py-3">
            <div class="flex items-center gap-2 w-full">
              <button
                @click="deleteLink()"
                class="flex items-center border justify-center w-full py-3 rounded-full text-gray-950 hover:text-gray-200 font-semibold hover:bg-gray-900"
              >
                Remove
              </button>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkBoxSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[280px] transition-all duration-300 ease-in mt-10':
                isUploadImage,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isUploadImage,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <svg
              @click="isUploadImage = false"
              color="#45494A"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="absolute right-1 top-[6px] cursor-pointer w-5 h-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>

            <div class="text-center text-sm font-bold text-[#45494A]">
              Add Thumbnail
            </div>
          </div>

          <div class="w-full flex items-center justify-between px-4 py-3">
            <div class="w-[50%]">
              <div class="w-[60px] flex items-center p-3 bg-gray-50 rounded-lg">
                <!-- https://sitegpt.ai/images/logo.svg -->
                <div v-if="link.image">
                  <img
                    class="rounded-lg w-[60px] aspect-square shadow-lg"
                    :src="link.image"
                  />
                </div>
                <div v-else-if="!link.image && link.faviconurl">
                  <img
                    class="rounded-lg w-[60px] aspect-square shadow-lg"
                    :src="link.faviconurl"
                  />
                </div>

                <div
                  v-else-if="!link.image && !link.faviconurl"
                  class="rounded-2xl shadow-lg bg-gray-200 p-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="rounded-lg text-gray-600 w-[35px]"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
                    />
                  </svg>
                </div>
              </div>
            </div>

            <div class="w-full pl-3">
              <button
                @click="openCropper = true"
                class="flex items-center justify-center w-[80%] py-3 rounded-full text-white font-semibold bg-[#8228D9] hover:bg-[#6c21b3] mb-2"
              >
                <span v-if="!link.faviconurl && !link.image">Choose Icon</span>
                <span v-else>Change Icon</span>
              </button>
            </div>
          </div>
          <div class="w-full flex items-center justify-between px-4 py-2">
            <div class="w-[50%]">
              <div
                class="flex items-center w-[180px] p-3 bg-gray-50 rounded-lg"
              >
                <!-- https://sitegpt.ai/images/og-image.png -->
                <img
                  v-if="link.thumbnailimage"
                  class="rounded-lg w-[280px] h-[80px] aspect-square object-cover shadow-lg"
                  :src="link.thumbnailimage"
                />
                <img
                  v-if="!link.thumbnailimage && link.thumbnailurl"
                  class="rounded-lg w-[280px] h-[80px] aspect-square object-cover shadow-lg"
                  :src="link.thumbnailurl"
                />

                <div
                  v-if="!link.thumbnailurl && !link.thumbnailimage"
                  class="rounded-2xl shadow-lg bg-gray-100 p-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="rounded-lg text-gray-600 w-[120px] h-[80px]"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
                    />
                  </svg>
                </div>
              </div>
            </div>

            <div class="w-full pl-3">
              <button
                @click="openThumbnailCropper = true"
                class="flex items-center justify-center w-[80%] py-3 rounded-full text-white font-semibold bg-[#8228D9] hover:bg-[#6c21b3] mb-2"
              >
                <span v-if="!link.thumbnailurl && !link.thumbnailimage"
                  >Choose Thumbnail</span
                >
                <span v-else>Change Thumbnail</span>
              </button>
            </div>
          </div>
        </div>

        <div
          id="FooterLinkLayoutSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[180px] transition-all duration-300 ease-in mt-10':
                isUpdateLayout,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isUpdateLayout,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <svg
              @click="isUpdateLayout = false"
              color="#45494A"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="absolute right-1 top-[6px] cursor-pointer w-5 h-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>

            <div class="text-center text-sm font-bold text-[#45494A]">
              Choose Layout
            </div>
          </div>

          <div class="w-full px-4 py-5">
            <form @submit.prevent="updateCategory()">
              <!-- Sizes -->
              <div class="mt-10">
                <RadioGroup v-model="selectedLayout" class="mt-4">
                  <RadioGroupLabel class="sr-only"
                    >Choose a size</RadioGroupLabel
                  >
                  <div
                    class="flex flex-row flex-wrap items-center justify-center"
                  >
                    <RadioGroupOption
                      as="template"
                      v-for="size in Layout"
                      :key="size.name"
                      :value="size.name"
                      v-slot="{ active, checked }"
                      class="min-w-[100px]"
                    >
                      <div
                        :class="[
                          active ? ' bg-gray-950 text-white' : 'text-gray-950',
                          'group  relative flex items-center justify-center  w-auto mb-3 rounded-full  py-0.5 px-1 text-sm font-medium hover:bg-gray-50 focus:outline-none ',
                        ]"
                      >
                        <span v-html="size.icon" />

                        <!-- <span
                                    :class="[
                                        active ? 'border' : 'border-2',
                                        checked
                                            ? ''
                                            : 'border-transparent',
                                        'pointer-events-none absolute -inset-px rounded-full',
                                    ]"
                                    aria-hidden="true"
                                /> -->
                      </div>
                    </RadioGroupOption>
                  </div>
                </RadioGroup>
              </div>

              <!-- <button
                type="submit"
                class="mt-6 flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
            >
                Save
            </button> -->
            </form>
          </div>
        </div>

        <div
          id="FooterAddWaitinglistBtnSection"
          class="overflow-hidden"
          :class="[
            {
              'max-h-[880px] overflow-hidden overflow-y-auto overflow-x-hidden transition-all duration-300 ease-in mt-10':
                isEditSaaSData,
            },
            {
              'max-h-0 transition-all duration-200 ease-out': !isEditSaaSData,
            },
          ]"
        >
          <div class="relative w-full bg-[#DFE2D9] py-1.5">
            <Icon
              @click="isEditSaaSData = false"
              name="mdi:close"
              class="absolute right-1 top-[6px] cursor-pointer"
              size="20"
              color="#45494A"
            />
            <div class="text-center text-sm font-bold text-[#45494A]">
              Add btn
            </div>
          </div>

          <div
            class="w-full flex flex-col items-center justify-between px-4 py-5"
          >
            <StartupCustomData :link="link" />
          </div>
        </div>

        <CropperModal
          v-if="openCropper"
          :linkId="link.id"
          @data="data = $event"
          @close="openCropper = false"
        />
        <CropperModal
          v-if="openThumbnailCropper"
          :linkId="link.id"
          @data="thumbnaildata = $event"
          @close="openCropper = false"
        />
      </div>
    </div>
  </div>
</template>

<script setup>
import {
  TransitionRoot,
  TransitionChild,
  Dialog,
  DialogPanel,
  DialogTitle,
  RadioGroup,
  RadioGroupLabel,
  RadioGroupOption,
} from "@headlessui/vue";
import StartupCustomData from "./StartupCustomData.vue";
import CropperModal from "./CropperModal.vue";
import debounce from "lodash/debounce";
import { watch, ref, onMounted, toRefs } from "vue";
import { useStore } from "vuex";
const store = useStore();

const props = defineProps({
  link: Object,
  selectedId: { type: Number, default: 0 },
  selectedStr: { type: String, default: "" },
});
const { link, selectedId, selectedStr } = toRefs(props);

const emit = defineEmits(["updatedInput"]);

let name = ref("");
let url = ref("");
let layout = ref("");
let data = ref(null);
let description = ref("");
let thumbnaildata = ref(null);
let isActive = ref(false);
let isDelete = ref(false);
let openCropper = ref(false);
let openThumbnailCropper = ref(false);
let isUploadImage = ref(false);
let isUpdateLayout = ref(false);
let isEditIndieLinkStatus = ref(false);
let isEditSaaSData = ref(false);
let errors = ref(null);

const Layout = [
  {
    name: "Cube",
    icon: `
        <svg
                            class="w-5 h-5"
                            viewBox="0 0 10 10"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.33333C1 1.97971 1.14048 1.64057 1.39052 1.39052C1.64057 1.14048 1.97971 1 2.33333 1H7.66667C8.02029 1 8.35943 1.14048 8.60948 1.39052C8.85952 1.64057 9 1.97971 9 2.33333V7.66667C9 8.02029 8.85952 8.35943 8.60948 8.60948C8.35943 8.85952 8.02029 9 7.66667 9H2.33333C1.97971 9 1.64057 8.85952 1.39052 8.60948C1.14048 8.35943 1 8.02029 1 7.66667V2.33333Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Verticalbar",

    icon: `
        <svg
                            class=""
                            width="31"
                            height="19"
                            viewBox="0 0 21 9"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.16667C1 1.85725 1.33363 1.5605 1.9275 1.34171C2.52136 1.12292 3.32681 1 4.16667 1H16.8333C17.6732 1 18.4786 1.12292 19.0725 1.34171C19.6664 1.5605 20 1.85725 20 2.16667V6.83333C20 7.14275 19.6664 7.4395 19.0725 7.65829C18.4786 7.87708 17.6732 8 16.8333 8H4.16667C3.32681 8 2.52136 7.87708 1.9275 7.65829C1.33363 7.4395 1 7.14275 1 6.83333V2.16667Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Horizontalbar",

    icon: `
        <svg
                            class=""
                            width="21"
                            height="13"
                            viewBox="0 0 21 13"
                            fill="none"
                            stroke="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M1 2.83333C1 2.3471 1.33363 1.88079 1.9275 1.53697C2.52136 1.19315 3.32681 1 4.16667 1H16.8333C17.6732 1 18.4786 1.19315 19.0725 1.53697C19.6664 1.88079 20 2.3471 20 2.83333V10.1667C20 10.6529 19.6664 11.1192 19.0725 11.463C18.4786 11.8068 17.6732 12 16.8333 12H4.16667C3.32681 12 2.52136 11.8068 1.9275 11.463C1.33363 11.1192 1 10.6529 1 10.1667V2.83333Z"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
      `,
  },
  {
    name: "Block",

    icon: `
        <svg class="" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M1 3.25C1 2.65326 1.23705 2.08097 1.65901 1.65901C2.08097 1.23705 2.65326 1 3.25 1H12.25C12.8467 1 13.419 1.23705 13.841 1.65901C14.2629 2.08097 14.5 2.65326 14.5 3.25V12.25C14.5 12.8467 14.2629 13.419 13.841 13.841C13.419 14.2629 12.8467 14.5 12.25 14.5H3.25C2.65326 14.5 2.08097 14.2629 1.65901 13.841C1.23705 13.419 1 12.8467 1 12.25V3.25Z"  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `,
  },
];

const selectedLayout = ref(Layout[0]);

console.log(link.value.thumbnailimage);
onMounted(() => {
  name.value = link.value.name;
  url.value = link.value.url;
  layout.value = link.value.layout;
  description.value = link.value.description;
  isActive.value = link.value.active ? true : false;
  selectedLayout.value = props.link.data?.Layout || "";
});

const updateLink = async () => {
  console.log(name.value);
  try {
    await store
      .dispatch("updateLink", {
        id: link.value.id,
        name: name.value,
        deascription: null,
        url: url.value,
        category: "SaaS",
        layout: layout.value,
        active: isActive.value,
      })
      .then(({ data }) => {
        store.commit("notify", {
          type: "success",
          message: "Saved",
        });
      });
    await store.dispatch("getAllLinks");
  } catch (error) {
    console.log(error);

    store.commit("notify", {
      type: "error",
      message: "Failed",
    });
    errors.value = error.response.data.errors;
  }
};

const editImage = () => {
  if (store.state.user.isMobile) {
    store.state.user.updatedLinkId = link.value.id;
  } else {
    isUploadImage.value = true;
    isDelete.value = false;
  }
};

const updateLinkImage = async () => {
  try {
    await store.dispatch("updateLinkImage", data.value).then(({ data }) => {
      store.commit("notify", {
        type: "success",
        message: "Saved",
      });
    });
    await store.dispatch("getAllLinks");
    setTimeout(() => (openCropper.value = false), 300);
  } catch (error) {
    console.log(error);
    openCropper.value = false;
    store.commit("notify", {
      type: "error",
      message: "Failed",
    });
  }
};
const updateThumbnailLinkImage = async () => {
  try {
    await store
      .dispatch("updateThumbnailLinkImage", thumbnaildata.value)
      .then(({ data }) => {
        store.commit("notify", {
          type: "success",
          message: "Saved",
        });
      });
    await store.dispatch("getAllLinks");
    setTimeout(() => (openThumbnailCropper.value = false), 300);
  } catch (error) {
    console.log(error);
    openCropper.value = false;
    store.commit("notify", {
      type: "error",
      message: "Failed",
    });
  }
};

const updateItemLayout = async () => {
  errors.value = null;

  try {
    console.log(selectedLayout.value);
    console.log(link.id);

    await store
      .dispatch("updateItemLayout", {
        Layout: selectedLayout.value,
        id: link.value.id,
      })
      .then(({ data }) => {
        store.commit("notify", {
          type: "success",
          message: "Saved",
        });
      });
  } catch (error) {
    console.log(error);
    store.commit("notify", {
      type: "error",
      message: "Failed",
    });
    //errors.value = error.response.data.errors;
  }
};

const deleteLink = async () => {
  let res = confirm("Are you sure you want to delete this link?");
  try {
    if (res) {
      await store.dispatch("deleteLink", link.value.id);
      await store.dispatch("getAllLinks");
    }
  } catch (error) {
    console.log(error);
  }
};

watch(
  () => data.value,
  async () => await updateLinkImage()
);

watch(
  () => thumbnaildata.value,
  async () => await updateThumbnailLinkImage()
);
</script>
